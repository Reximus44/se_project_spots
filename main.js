!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=e=>{document.querySelectorAll(e.formSelector).forEach((o=>{((e,o)=>{const n=Array.from(e.querySelectorAll(o.inputSelector)),a=e.querySelector(o.submitButtonSelector);r(n,a,o),n.forEach((s=>{s.addEventListener("input",(function(){((e,r,o)=>{console.log(r.validationMessage),r.validity.valid?t(e,r,o):((e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent=t.validationMessage,t.classList.add(r.inputErrorClass)})(e,r,o)})(e,s,o),r(n,a,o)}))}))})(o,e)}))};n(e);function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}const s=document.querySelector(".profile__edit-btn"),l=document.querySelector(".profile__add-btn"),c=document.querySelector(".profile__avatar-btn"),i=document.querySelector(".profile__name"),d=document.querySelector(".profile__description"),u=document.querySelector("#add-card-form"),m=document.querySelector(".profile__avatar"),_=document.querySelector("#edit-modal"),h=_.querySelector(".modal__form"),f=(_.querySelector(".modal__close-btn"),_.querySelector("#profile-name-input")),v=_.querySelector("#profile-description-input"),S=document.querySelector("#add-card-modal"),y=S.querySelector(".modal__form"),b=S.querySelector(".modal__submit-btn"),p=(S.querySelector(".modal__close-btn"),S.querySelector("#add-card-name-input")),q=S.querySelector("#add-card-link-input"),E=document.querySelector("#avatar-modal"),k=E.querySelector(".modal__form"),g=(E.querySelector(".modal__submit-btn"),E.querySelector(".modal__close-btn"),E.querySelector("#profile-avatar-input")),L=document.querySelector("#delete-modal"),C=L.querySelector(".modal__form"),$=document.querySelector("#preview-modal"),j=$.querySelector(".modal__image"),U=$.querySelector(".modal__caption"),x=document.querySelector(".cards__list"),P=document.querySelector("#card-template");let I,A;const T=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a1b47911-56f8-4c22-a365-89f4ae3c2c1b","Content-Type":"application/json"}});function w(e){document.addEventListener("keydown",B),e.addEventListener("mousedown",D),e.classList.add("modal_opened")}T.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=O(e);x.append(t)})),i.textContent=r.name,d.textContent=r.about,m.src=r.avatar})).catch(console.error);const D=e=>{(e.currentTarget===e.target||e.target.classList.contains("modal__close-btn")||"delete-modal-cancel-btn"===e.target.id)&&N(e.currentTarget)};function B(e){"Escape"===e.key&&N(document.querySelector(".modal_opened"))}function N(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",B),e.removeEventListener("mousedown",D)}function O(e){const t=P.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return e.isLiked&&n.classList.add("card__like-btn_liked"),r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(t=>function(e,t){const r=e.target.classList.contains("card__like-btn_liked");T.changeLikeStatus(t,r).then((t=>{e.target.classList.toggle("card__like-btn_liked")})).catch(console.error)}(t,e._id))),a.addEventListener("click",(r=>function(e,t){I=e,A=t,w(L)}(t,e._id))),o.addEventListener("click",(()=>{w($),j.src=e.link,U.textContent=e.name,j.alt=e.name})),t}s.addEventListener("click",(()=>{var r,o;f.value=i.textContent,v.value=d.textContent,r=h,o=e,[f,v].forEach((e=>{t(r,e,o)})),w(_)})),l.addEventListener("click",(()=>{w(S)})),h.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;a(t,!0,"Save","Saving..."),T.editUserInfo({name:f.value,about:v.value}).then((e=>{i.textContent=e.name,d.textContent=e.about,N(_)})).catch(console.error).finally((()=>{a(t,!1)}))})),y.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;a(r,!0,"Save","Saving...");const n={name:p.value,link:q.value};T.addCard(n).then((t=>{const r=O(n);x.prepend(r),o(b,e),N(S),u.reset()})).catch(console.error).finally((()=>{a(r,!1)}))})),c.addEventListener("click",(()=>{w(E)})),k.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;a(t,!0,"Save","Saving..."),T.editAvatarInfo(g.value).then((e=>{m.src=e.avatar,N(E)})).catch(console.error).finally((()=>{a(t,!1)}))})),C.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Deleting...",T.deleteCard(A).then((()=>{I.remove(),N(L)})).catch(console.error).finally((()=>{t.textContent="Delete"}))})),document.querySelector(".modal__close-btn_type_preview"),document.querySelector("#preview-modal"),n(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFDdEI5RyxFQUFjNkcsR0FBVyxFQUFNLE9BQVEsYUFDdkN6RSxFQUNHK0IsZUFBZXpDLEVBQWdCaUYsT0FDL0I3RCxNQUFNK0MsSUFDTC9FLEVBQWdCcUUsSUFBTVUsRUFBS3pCLE9BQzNCc0IsRUFBV2xFLEVBQVksSUFFeEI0RCxNQUFNeEYsUUFBUXlGLE9BQ2QwQixTQUFRLEtBQ1AvRyxFQUFjNkcsR0FBVyxFQUFNLEdBRXJDLElBNEZBakYsRUFBV2xDLGlCQUFpQixVQTFGNUIsU0FBNEI0RixHQUMxQkEsRUFBSXNCLGlCQUNKLE1BQU1DLEVBQVl2QixFQUFJd0IsVUFFdEJELEVBQVUzSSxZQUFjLGNBQ3hCa0UsRUFDR2lDLFdBQVdsQyxHQUNYVyxNQUFLLEtBRUpaLEVBQWE5RCxTQUVic0gsRUFBVy9ELEVBQVksSUFFeEJ5RCxNQUFNeEYsUUFBUXlGLE9BQ2QwQixTQUFRLEtBRVBGLEVBQVUzSSxZQUFjLFFBQVEsR0FFdEMsSUE0RTZCZSxTQUFTakIsY0FDcEMsa0NBR3dCaUIsU0FBU2pCLGNBQWMsa0JBRWpEZ0IsRUFBaUIzQixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idG5cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc29sZS5sb2coaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uRWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xyXG5cclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcclxuICBidG4sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbikge1xyXG4gIGlmIChpc0xvYWRpbmcpIHtcclxuICAgIC8vIHNldCB0aGUgbG9hZGluZyB0ZXh0XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgLy8gc2V0IG5vdCBsb2FkaW5nIHRleHRcclxuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldFN1Ym1pdEJ1dHRvblRleHQoYnV0dG9uLCB0ZXh0KSB7XHJcbiAgYnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcclxufVxyXG4iLCIvLyBUT0RPIC0gUGFzcyBzZXR0aW5ncyBvYmplY3QgdG8gdGhlIHZhbGlkYXRpb24gZnVuY3Rpb25zIHRoYXQgYXJlIGNhbGxlZCBpbiB0aGlzIGZpbGVcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBkaXNhYmxlQnV0dG9uLFxuICByZXNldFZhbGlkYXRpb24sXG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCB7IHNldEJ1dHRvblRleHQsIHNldFN1Ym1pdEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xuXG4vLyBQcm9maWxlIGVsZW1lbnRzXG5jb25zdCBlZGl0TW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgY2FyZE1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xuY29uc3QgYXZhdGFyTW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XG5jb25zdCBwcm9maWxlTmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuXG4vLyBBdmF0YXIgZWxlbWVudFxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcblxuLy8gRm9ybSBlbGVtZW50c1xuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuY29uc3QgZWRpdEZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnRuID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IG5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xuXG4vLyBDYXJkIGZvcm0gZWxlbWVudHNcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBjYXJkRm9ybSA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcblxuLy8gQXZhdGFyIGZvcm0gZWxlbWVudHNcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5jb25zdCBhdmF0YXJNb2RhbENsb3NlQnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgYXZhdGFyTGlua0lucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcblxuLy8gRGVsZXRlIGZvcm0gZWxlbWVudHNcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuLy8gU2VsZWN0IHRoZSBtb2RhbFxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vLyBDYXJkIHJlbGF0ZWQgZWxlbWVudHNcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5cbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhMWI0NzkxMS01NmY4LTRjMjItYTM2NS04OWY0YWUzYzJjMWJcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5hcGlcbiAgLmdldEFwcEluZm8oKVxuICAudGhlbigoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICAgICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG4gICAgcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICBwcm9maWxlQXZhdGFyRWwuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU1vZGFsQ2xpY2spO1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xufVxuXG5jb25zdCBoYW5kbGVNb2RhbENsaWNrID0gKGV2dCkgPT4ge1xuICBpZiAoXG4gICAgZXZ0LmN1cnJlbnRUYXJnZXQgPT09IGV2dC50YXJnZXQgfHxcbiAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idG5cIikgfHxcbiAgICBldnQudGFyZ2V0LmlkID09PSBcImRlbGV0ZS1tb2RhbC1jYW5jZWwtYnRuXCJcbiAgKSB7XG4gICAgY2xvc2VNb2RhbChldnQuY3VycmVudFRhcmdldCk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGNsb3NlTW9kYWwob3BlbmVkTW9kYWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVNb2RhbENsaWNrKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAvLyAgY2hhbmdlIHRleHQgY29udGVudCB0byBcIlNhdmluZy4uLlwiXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyh7IG5hbWU6IG5hbWVJbnB1dC52YWx1ZSwgYWJvdXQ6IGRlc2NyaXB0aW9uSW5wdXQudmFsdWUgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIC8vIFRPRE8gLSBjYWxsIHNldEJ1dHRvblRleHQgaW5zdGVhZFxuICAgICAgLy8gQ2hhbmdlIHRleHQgY29udGVudCBiYWNrIHRvIFwiU2F2ZVwiXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyBUT0RPIC0gaW1wbGVtZW50IGxvYWRpbmcgdGV4dCBmb3IgYWxsIG90aGVyIGZvcm0gc3VibWlzc2lvbnNcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0geyBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLCBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlIH07XG4gIGFwaVxuICAgIC5hZGRDYXJkKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcbiAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgICAgYWRkQ2FyZEZvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC5lZGl0QXZhdGFySW5mbyhhdmF0YXJMaW5rSW5wdXQudmFsdWUpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSBkYXRhLmF2YXRhcjtcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgLy9zZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuICBhcGlcbiAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAvLyByZW1vdmUgdGhlIGNhcmQgZnJvbSB0aGUgRE9NXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XG4gICAgICAvLyBjbG9zZSB0aGUgbW9kYWxcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgLy9zZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiRGVsZXRlXCIpO1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJEZWxldGVcIjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XG4gIGNvbnN0IGlzTGlrZWQgPSBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICBhcGlcbiAgICAuY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xuXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH1cblxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcblxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4gaGFuZGxlTGlrZShldnQsIGRhdGEuX2lkKSk7XG5cbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhLl9pZClcbiAgKTtcblxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5lZGl0TW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgbmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudDtcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oZWRpdEZvcm0sIFtuYW1lSW5wdXQsIGRlc2NyaXB0aW9uSW5wdXRdLCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xufSk7XG5cbmNhcmRNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcbn0pO1xuXG5lZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcbmNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmF2YXRhck1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XG59KTtcblxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG4vLyBNb2RhbCBwcmV2aWV3IGNsb3NlIGJ1dHRvblxuXG5jb25zdCBjbG9zZU1vZGFsUHJldmlld0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZS1idG5fdHlwZV9wcmV2aWV3XCJcbik7XG5cbmNvbnN0IGNsb3NlTW9kYWxQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsIi8vIHV0aWxzL0FwaS5qc1xyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAvLyBjb25zdHJ1Y3RvciBib2R5XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgLy8gY3JlYXRlIGFub3RoZXIgbWV0aG9kLCBjYWxsZWQgZ2V0VXNlckluZm8gKGRpZmZlcmVudCBiYXNlIHVybClcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICAvLyBjYWxsIGdldFVzZXJJbmZvIGluIHRoaXMgYXJyYXlcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG4gIC8vIFRPRE8gLSBpbXBsZW1lbnQgUE9TVCAvY2FyZHNcclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiZm9ybUVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJidXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImNvbnNvbGUiLCJsb2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNob3dJbnB1dEVycm9yIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJlZGl0TW9kYWxCdG4iLCJjYXJkTW9kYWxCdG4iLCJhdmF0YXJNb2RhbEJ0biIsInByb2ZpbGVOYW1lRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsImFkZENhcmRGb3JtIiwicHJvZmlsZUF2YXRhckVsIiwiZWRpdE1vZGFsIiwiZWRpdEZvcm0iLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiY2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkU3VibWl0QnRuIiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJMaW5rSW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxJbWFnZUVsIiwicHJldmlld01vZGFsQ2FwdGlvbkVsIiwiY2FyZHNMaXN0IiwiY2FyZFRlbXBsYXRlIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJfcmVmMiIsIm5hbWUiLCJsaW5rIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckluZm8iLCJfcmVmMyIsImFib3V0IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwib3Blbk1vZGFsIiwibW9kYWwiLCJoYW5kbGVFc2NhcGUiLCJoYW5kbGVNb2RhbENsaWNrIiwiY2FyZHMiLCJ1c2VyRGF0YSIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50IiwiYXBwZW5kIiwic3JjIiwiY2F0Y2giLCJlcnJvciIsImV2dCIsImN1cnJlbnRUYXJnZXQiLCJ0YXJnZXQiLCJjb250YWlucyIsImNsb3NlTW9kYWwiLCJrZXkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJhbHQiLCJ0b2dnbGUiLCJoYW5kbGVMaWtlIiwiX2lkIiwiY2FyZElkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJmaW5hbGx5IiwiaW5wdXRWYWx1ZXMiLCJwcmVwZW5kIiwicmVzZXQiXSwic291cmNlUm9vdCI6IiJ9